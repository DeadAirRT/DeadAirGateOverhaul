<?xml version='1.0' encoding='utf-8'?>
<diff>
  <replace sel="/aiscript/order[@id='MiningRoutine'][@name='{1041, 341}']/params/param[@type='number'][@name='minbuy']/input_param[@value='[([@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3) - 1, 0].max'][@name='max']/@value">[[@this.ship.commander.tradenpc.skill.management - 1, @this.ship.commander.pilot.skill.management - 1, @this.ship.pilot.skill.piloting - 1].max,11].max</replace>
  <replace sel="/aiscript/order[@id='MiningRoutine'][@name='{1041, 341}']/params/param[@type='number'][@name='maxbuy']/input_param[@value='[@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3'][@name='max']/@value">[[@this.ship.commander.tradenpc.skill.management, @this.ship.commander.pilot.skill.management, @this.ship.pilot.skill.piloting].max,12].max</replace>
  <replace sel="/aiscript/order[@id='MiningRoutine'][@name='{1041, 341}']/params/param[@type='number'][@name='minsell']/input_param[@value='[([@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3) - 1, 0].max'][@name='max']/@value">[[@this.ship.commander.tradenpc.skill.management - 1, @this.ship.commander.pilot.skill.management - 1, @this.ship.pilot.skill.piloting - 1].max,11].max</replace>
  <replace sel="/aiscript/order[@id='MiningRoutine'][@name='{1041, 341}']/params/param[@type='number'][@name='maxsell']/input_param[@value='[@this.ship.commander.tradenpc.skill.management, @this.ship.pilot.skill.piloting].max / 3'][@name='max']/@value">[[@this.ship.commander.tradenpc.skill.management, @this.ship.commander.pilot.skill.management, @this.ship.pilot.skill.piloting].max,12].max</replace>
  <replace sel="/aiscript/init/do_if[@value='this.isplayerowned']/set_value[@exact='[@this.assignedcontrolled.commander.tradenpc.skill.management, @this.skill.piloting].max / 3'][@name='$maxrange']/@exact">[[@this.ship.commander.tradenpc.skill.management, @this.ship.commander.pilot.skill.management, @this.ship.pilot.skill.piloting].max,12].max</replace>
  <remove sel="/aiscript/init/do_if[@value='this.isplayerowned']/do_if[@value='$effectiveskill == 100']"/>
  <replace sel="/aiscript/init/do_if[@value='this.isplayerowned']/do_if[@value='$maxsell gt $maxrange']">
    <do_if value="not @$homebase.isoperational">
      </do_if>
  </replace>
  <remove sel="/aiscript/init/do_if[@value='this.isplayerowned']/do_if[@value='not @$homebase.isoperational'][2]"/>
  <replace sel="/aiscript/init/do_if[@value='($effectiveskill != 0) and ($effectiveskill != 100)']/@value">($effectiveskill != 100)</replace>
  <replace sel="/aiscript/init/do_if[@value='($effectiveskill != 100)']/set_value[@exact='this.assignedcontrolled.combinedskill'][@name='$effectiveskill']/@exact">100</replace>
</diff>
